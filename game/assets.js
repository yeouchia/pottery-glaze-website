/**
 * Lineage M v77.90 Assets Module (Visual Fixes & Performance)
 * ---------------------------------------------------
 * [本階段修正 - 第一階段 v77.83]
 * 1. [優化] effect_meteor_rain: 簡化 SVG 結構以解決瀏覽器 LAG 問題，改用高對比視覺。
 * 2. [新增] effect_fire_storm: 重製為明顯的地面火焰旋渦，對應 AOE 範圍。
 * 3. [校正] effect_slash (騎士): 調整揮劍軌跡，將握柄處對齊圖片中心，修正「憑空揮劍」問題。
 * 4. [校正] effect_staff_swing (法師): 調整揮杖軌跡，確保旋轉軸心在手部位置。
 * ---------------------------------------------------
 */

// 全域資源儲存庫
var Assets = {};

/**
 * 建立 SVG 圖像資源的工廠函式
 */
function createSvgAsset(key, svgContent, width=150, height=150) { 
    var svg = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 120 120" width="${width}" height="${height}">${svgContent}</svg>`; 
    var blob = new Blob([svg], {type: 'image/svg+xml'}); 
    var url = URL.createObjectURL(blob); 
    var img = new Image(); 
    img.src = url; 
    Assets[key] = img; 
}

/**
 * 初始化所有內建美術資源
 */
function initAssets() {
    // --- 角色資源 (保持 v77.81 配色) ---
    createSvgAsset('char_knight', `<defs><linearGradient id="gS" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#eee"/><stop offset="100%" stop-color="#999"/></linearGradient></defs><ellipse cx="60" cy="110" rx="30" ry="8" fill="rgba(0,0,0,0.5)" /><path d="M40,40 Q60,20 80,40 L90,100 Q60,115 30,100 Z" fill="#800" stroke="#300" stroke-width="1"/><path d="M45,40 L75,40 L80,90 L40,90 Z" fill="url(#gS)" stroke="#333" stroke-width="1"/><rect x="50" y="50" width="20" height="30" fill="#bbb" /><path d="M45,15 L75,15 L75,45 L45,45 Z" fill="#ccc" stroke="#333"/><path d="M50,30 L70,30" stroke="#000" stroke-width="3"/><rect x="45" y="90" width="12" height="20" fill="#888" stroke="#333"/><rect x="63" y="90" width="12" height="20" fill="#888" stroke="#333"/><g transform="translate(80, 50) rotate(-10)"><rect x="-2" y="-10" width="4" height="20" fill="#630" /><rect x="-6" y="-12" width="12" height="4" fill="#888" /><path d="M-3,-12 L-3,-60 L0,-65 L3,-60 L3,-12 Z" fill="#ddd" stroke="#888" /></g>`);
    createSvgAsset('char_elf', `<ellipse cx="60" cy="110" rx="30" ry="8" fill="rgba(0,0,0,0.5)" /><path d="M45,40 L75,40 L78,85 L42,85 Z" fill="#bcf5bc" stroke="#32cd32" stroke-width="1"/><rect x="50" y="50" width="20" height="30" fill="#7fff00" /><circle cx="60" cy="30" r="14" fill="#fdcb9e" /><path d="M46,20 Q60,10 74,20" fill="none" stroke="#ffd700" stroke-width="2"/><rect x="45" y="85" width="10" height="25" fill="#d2691e" /><rect x="65" y="85" width="10" height="25" fill="#d2691e" /><g transform="translate(20, 50)"><path d="M10,0 Q30,20 10,40" fill="none" stroke="#8b4513" stroke-width="3"/><line x1="10" y1="0" x2="10" y2="40" stroke="#fff" stroke-width="1"/></g>`);
    createSvgAsset('char_mage', `<ellipse cx="60" cy="110" rx="30" ry="8" fill="rgba(0,0,0,0.5)" /><path d="M40,40 L80,40 L90,105 L30,105 Z" fill="#483d8b" stroke="#113" stroke-width="1"/><path d="M50,40 L70,40 L70,105 Z" fill="#9932cc" /><circle cx="60" cy="30" r="12" fill="#fdcb9e" /><path d="M45,25 L75,25 L60,10 Z" fill="#40e0d0" /><g transform="translate(85, 60) rotate(10)"><rect x="-2" y="-40" width="4" height="80" fill="#8b4513" /><circle cx="0" cy="-45" r="5" fill="#ffd700" stroke="#fff" /></g>`);

    // --- 變身資源 (維持 v77.81 修正後的高對比配色) ---
    createSvgAsset('morph_dk_gold', `<path d="M40,40 Q60,20 80,40 L90,100 Q60,115 30,100 Z" fill="#520" stroke="#310" stroke-width="2"/><path d="M45,40 L75,40 L80,90 L40,90 Z" fill="#b86" stroke="#530" stroke-width="2"/><rect x="50" y="50" width="20" height="30" fill="#d92" /><rect x="45" y="90" width="12" height="20" fill="#b86" stroke="#530" /><rect x="63" y="90" width="12" height="20" fill="#b86" stroke="#530" /><path d="M30,45 L45,40 L40,60 Z" fill="#fd0" stroke="#b82" stroke-width="1"/><path d="M90,45 L75,40 L80,60 Z" fill="#fd0" stroke="#b82" stroke-width="1"/><path d="M45,15 L75,15 L75,45 L45,45 Z" fill="#530" stroke="#000" stroke-width="2"/><path d="M45,20 L35,5 L48,15 Z" fill="#d92" /><path d="M75,20 L85,5 L72,15 Z" fill="#d92" /><circle cx="53" cy="25" r="3" fill="#ff0"><animate attributeName="opacity" values="0.5;1;0.5" dur="1s" repeatCount="indefinite" /></circle><circle cx="67" cy="25" r="3" fill="#ff0"><animate attributeName="opacity" values="0.5;1;0.5" dur="1s" repeatCount="indefinite" /></circle><g transform="translate(80, 50) rotate(-10)"><rect x="-2" y="-10" width="4" height="20" fill="#444" /><path d="M-4,-12 L-4,-60 L0,-65 L4,-60 L4,-12 Z" fill="#fe2" stroke="#d92" /><path d="M0,-20 L0,-55" stroke="#fff" stroke-width="1" opacity="0.8" /></g><circle cx="60" cy="110" r="30" fill="none" stroke="#fd0" stroke-width="1" stroke-dasharray="5,5" opacity="0.4"><animateTransform attributeName="transform" type="rotate" from="0 60 110" to="360 60 110" dur="8s" repeatCount="indefinite"/></circle>`);
    createSvgAsset('morph_dk_platinum', `<path d="M40,40 Q60,20 80,40 L90,100 Q60,115 30,100 Z" fill="#e6e6fa" stroke="#9370db" stroke-width="2"/><path d="M45,40 L75,40 L80,90 L40,90 Z" fill="#f8f8ff" stroke="#8a2be2" stroke-width="2"/><rect x="50" y="50" width="20" height="30" fill="#fff" /><rect x="45" y="90" width="12" height="20" fill="#f8f8ff" stroke="#8a2be2" /><rect x="63" y="90" width="12" height="20" fill="#f8f8ff" stroke="#8a2be2" /><path d="M30,45 L45,40 L40,60 Z" fill="#dda0dd" stroke="#8a2be2" stroke-width="1"/><path d="M90,45 L75,40 L80,60 Z" fill="#dda0dd" stroke="#8a2be2" stroke-width="1"/><path d="M45,15 L75,15 L75,45 L45,45 Z" fill="#4b0082" stroke="#000" stroke-width="2"/><path d="M45,20 L35,5 L48,15 Z" fill="#9370db" /><path d="M75,20 L85,5 L72,15 Z" fill="#9370db" /><circle cx="53" cy="25" r="3" fill="#0ff"><animate attributeName="opacity" values="0.5;1;0.5" dur="1.5s" repeatCount="indefinite" /></circle><circle cx="67" cy="25" r="3" fill="#0ff"><animate attributeName="opacity" values="0.5;1;0.5" dur="1.5s" repeatCount="indefinite" /></circle><g transform="translate(80, 50) rotate(-10)"><rect x="-2" y="-10" width="4" height="20" fill="#444" /><path d="M-4,-12 L-4,-60 L0,-65 L4,-60 L4,-12 Z" fill="#fff" stroke="#ccf" /><path d="M0,-20 L0,-55" stroke="#0ff" stroke-width="1" opacity="0.8" /></g><circle cx="60" cy="110" r="30" fill="none" stroke="#0ff" stroke-width="1" stroke-dasharray="5,5" opacity="0.5"><animateTransform attributeName="transform" type="rotate" from="0 60 110" to="-360 60 110" dur="10s" repeatCount="indefinite"/></circle>`);
    createSvgAsset('morph_dk_red', `<path d="M40,40 Q60,20 80,40 L90,100 Q60,115 30,100 Z" fill="#800000" stroke="#ff4500" stroke-width="2"/><path d="M45,40 L75,40 L80,90 L40,90 Z" fill="#ff0000" stroke="#8b0000" stroke-width="2"/><rect x="50" y="50" width="20" height="30" fill="#ff6347" /><rect x="45" y="90" width="12" height="20" fill="#ff0000" stroke="#8b0000" /><rect x="63" y="90" width="12" height="20" fill="#ff0000" stroke="#8b0000" /><path d="M30,45 L45,40 L40,60 Z" fill="#ff4500" stroke="#8b0000" stroke-width="1"/><path d="M90,45 L75,40 L80,60 Z" fill="#ff4500" stroke="#8b0000" stroke-width="1"/><path d="M45,15 L75,15 L75,45 L45,45 Z" fill="#8b0000" stroke="#000" stroke-width="2"/><path d="M45,20 L35,5 L48,15 Z" fill="#ff8c00" /><path d="M75,20 L85,5 L72,15 Z" fill="#ff8c00" /><circle cx="53" cy="25" r="3" fill="#ffd700"><animate attributeName="opacity" values="0.5;1;0.5" dur="0.5s" repeatCount="indefinite" /></circle><circle cx="67" cy="25" r="3" fill="#ffd700"><animate attributeName="opacity" values="0.5;1;0.5" dur="0.5s" repeatCount="indefinite" /></circle><g transform="translate(80, 50) rotate(-10)"><rect x="-2" y="-10" width="4" height="20" fill="#444" /><path d="M-4,-12 L-4,-60 L0,-65 L4,-60 L4,-12 Z" fill="#ff4500" stroke="#800" /><path d="M0,-20 L0,-55" stroke="#ffff00" stroke-width="1" opacity="0.8" /></g><circle cx="60" cy="110" r="30" fill="none" stroke="#ff0000" stroke-width="1" stroke-dasharray="5,5" opacity="0.6"><animateTransform attributeName="transform" type="rotate" from="0 60 110" to="360 60 110" dur="5s" repeatCount="indefinite"/></circle>`);
    createSvgAsset('morph_high_elf', `<ellipse cx="60" cy="110" rx="30" ry="8" fill="rgba(0,0,0,0.5)" /><path d="M40,40 Q60,20 80,40 L90,95 Q60,110 30,95 Z" fill="#fff" stroke="#ffd700" stroke-width="1"/><path d="M45,40 L75,40 L78,85 L42,85 Z" fill="#90ee90" stroke="#006400" stroke-width="1"/><rect x="50" y="50" width="20" height="30" fill="#32cd32" /><path d="M40,40 L30,45 L42,55 Z" fill="#daa520" stroke="#8b4513" /><path d="M80,40 L90,45 L78,55 Z" fill="#daa520" stroke="#8b4513" /><circle cx="60" cy="30" r="14" fill="#fdcb9e" /><path d="M46,20 Q60,5 74,20" fill="none" stroke="#ffd700" stroke-width="3"/><rect x="45" y="85" width="10" height="25" fill="#90ee90" stroke="#006400" /><rect x="65" y="85" width="10" height="25" fill="#90ee90" stroke="#006400" /><g transform="translate(20, 50)"><path d="M10,-10 Q40,20 10,50" fill="none" stroke="#daa520" stroke-width="4" filter="drop-shadow(0 0 5px #daa520)"/><line x1="10" y1="-10" x2="10" y2="50" stroke="#fff" stroke-width="1"/></g>`);

    createSvgAsset('morph_dk_silver_60', `<path d="M40,40 Q60,20 80,40 L90,100 Q60,115 30,100 Z" fill="#1a2530" stroke="#7f8c8d" stroke-width="2"/><path d="M45,40 L75,40 L80,90 L40,90 Z" fill="#bdc3c7" stroke="#34495e" stroke-width="2"/><rect x="50" y="50" width="20" height="30" fill="#ecf0f1" /><rect x="45" y="90" width="12" height="20" fill="#95a5a6" stroke="#2c3e50" /><rect x="63" y="90" width="12" height="20" fill="#95a5a6" stroke="#2c3e50" /><path d="M30,45 L45,40 L40,60 Z" fill="#fff" stroke="#2c3e50" stroke-width="1"/><path d="M90,45 L75,40 L80,60 Z" fill="#fff" stroke="#2c3e50" stroke-width="1"/><path d="M45,15 L75,15 L75,45 L45,45 Z" fill="#2c3e50" stroke="#000" stroke-width="2"/><path d="M45,20 L35,5 L48,15 Z" fill="#ecf0f1" /><path d="M75,20 L85,5 L72,15 Z" fill="#ecf0f1" /><circle cx="53" cy="25" r="3" fill="#3498db"><animate attributeName="opacity" values="0.5;1;0.5" dur="2s" repeatCount="indefinite" /></circle><circle cx="67" cy="25" r="3" fill="#3498db"><animate attributeName="opacity" values="0.5;1;0.5" dur="2s" repeatCount="indefinite" /></circle><g transform="translate(80, 50) rotate(-10)"><rect x="-2" y="-10" width="4" height="20" fill="#2c3e50" /><path d="M-4,-12 L-4,-60 L0,-65 L4,-60 L4,-12 Z" fill="#f0f3f4" stroke="#7f8c8d" /><path d="M0,-20 L0,-55" stroke="#3498db" stroke-width="1" opacity="0.8" /></g>`);
    createSvgAsset('morph_dk_mystic_60', `<path d="M40,40 Q60,20 80,40 L90,100 Q60,115 30,100 Z" fill="#300030" stroke="#4b0082" stroke-width="2"/><path d="M45,40 L75,40 L80,90 L40,90 Z" fill="#551a8b" stroke="#800080" stroke-width="2"/><rect x="50" y="50" width="20" height="30" fill="#9932cc" /><rect x="45" y="90" width="12" height="20" fill="#4b0082" stroke="#800080" /><rect x="63" y="90" width="12" height="20" fill="#4b0082" stroke="#800080" /><path d="M30,45 L45,40 L40,60 Z" fill="#ba55d3" stroke="#4b0082" stroke-width="1"/><path d="M90,45 L75,40 L80,60 Z" fill="#ba55d3" stroke="#4b0082" stroke-width="1"/><path d="M45,15 L75,15 L75,45 L45,45 Z" fill="#191970" stroke="#000" stroke-width="2"/><path d="M45,20 L35,5 L48,15 Z" fill="#00ced1" /><path d="M75,20 L85,5 L72,15 Z" fill="#00ced1" /><circle cx="53" cy="25" r="3" fill="#00ffff"><animate attributeName="opacity" values="0.5;1;0.5" dur="1s" repeatCount="indefinite" /></circle><circle cx="67" cy="25" r="3" fill="#00ffff"><animate attributeName="opacity" values="0.5;1;0.5" dur="1s" repeatCount="indefinite" /></circle><g transform="translate(80, 50) rotate(-10)"><rect x="-2" y="-10" width="4" height="20" fill="#191970" /><path d="M-4,-12 L-4,-60 L0,-65 L4,-60 L4,-12 Z" fill="#00ced1" stroke="#fff" /><path d="M0,-20 L0,-55" stroke="#fff" stroke-width="2" opacity="0.9" /></g>`);
    createSvgAsset('morph_dk_orange_60', `<path d="M40,40 Q60,20 80,40 L90,100 Q60,115 30,100 Z" fill="#3e1c00" stroke="#8b4500" stroke-width="2"/><path d="M45,40 L75,40 L80,90 L40,90 Z" fill="#d2691e" stroke="#8b4513" stroke-width="2"/><rect x="50" y="50" width="20" height="30" fill="#ff8c00" /><rect x="45" y="90" width="12" height="20" fill="#8b4513" stroke="#3e1c00" /><rect x="63" y="90" width="12" height="20" fill="#8b4513" stroke="#3e1c00" /><path d="M30,45 L45,40 L40,60 Z" fill="#ffa500" stroke="#d2691e" stroke-width="1"/><path d="M90,45 L75,40 L80,60 Z" fill="#ffa500" stroke="#d2691e" stroke-width="1"/><path d="M45,15 L75,15 L75,45 L45,45 Z" fill="#5e2605" stroke="#000" stroke-width="2"/><path d="M45,20 L35,5 L48,15 Z" fill="#ffd700" /><path d="M75,20 L85,5 L72,15 Z" fill="#ffd700" /><circle cx="53" cy="25" r="3" fill="#ff0"><animate attributeName="opacity" values="0.5;1;0.5" dur="1s" repeatCount="indefinite" /></circle><circle cx="67" cy="25" r="3" fill="#ff0"><animate attributeName="opacity" values="0.5;1;0.5" dur="1s" repeatCount="indefinite" /></circle><g transform="translate(80, 50) rotate(-10)"><rect x="-2" y="-10" width="4" height="20" fill="#5e2605" /><path d="M-4,-12 L-4,-60 L0,-65 L4,-60 L4,-12 Z" fill="#ff8c00" stroke="#8b4500" /><path d="M0,-20 L0,-55" stroke="#ffd700" stroke-width="1" opacity="0.8" /></g>`);
    createSvgAsset('morph_ranger_60', `<ellipse cx="60" cy="110" rx="30" ry="8" fill="rgba(0,0,0,0.5)" /><path d="M40,40 Q60,20 80,40 L90,95 Q60,110 30,95 Z" fill="#006400" stroke="#004400" stroke-width="1"/><path d="M45,40 L75,40 L78,85 L42,85 Z" fill="#228b22" stroke="#006400" stroke-width="1"/><rect x="50" y="50" width="20" height="30" fill="#32cd32" /><path d="M40,40 L30,45 L42,55 Z" fill="#8b4513" stroke="#000" /><path d="M80,40 L90,45 L78,55 Z" fill="#8b4513" stroke="#000" /><circle cx="60" cy="30" r="14" fill="#fdcb9e" /><path d="M46,20 Q60,5 74,20" fill="none" stroke="#006400" stroke-width="3"/><rect x="45" y="85" width="10" height="25" fill="#228b22" stroke="#006400" /><rect x="65" y="85" width="10" height="25" fill="#228b22" stroke="#006400" /><g transform="translate(20, 50)"><path d="M10,-10 Q40,20 10,50" fill="none" stroke="#daa520" stroke-width="4" filter="drop-shadow(0 0 5px #daa520)"/><line x1="10" y1="-10" x2="10" y2="50" stroke="#fff" stroke-width="1"/></g>`);

    var rainbowAnim = `<animate attributeName="stroke" values="#f00;#ff0;#0f0;#0ff;#00f;#f0f;#f00" dur="2s" repeatCount="indefinite" />`;
    var rainbowFill = `<animate attributeName="fill" values="#f00;#ff0;#0f0;#0ff;#00f;#f0f;#f00" dur="2s" repeatCount="indefinite" />`;
    createSvgAsset('morph_dk_gold_70', `<path d="M40,40 Q60,20 80,40 L90,100 Q60,115 30,100 Z" fill="#400" stroke="#ffd700" stroke-width="2">${rainbowAnim}</path><path d="M45,40 L75,40 L80,90 L40,90 Z" fill="#d4af37" stroke="#ffd700" stroke-width="2"><animate attributeName="filter" values="drop-shadow(0 0 5px gold);drop-shadow(0 0 15px gold);drop-shadow(0 0 5px gold)" dur="1s" repeatCount="indefinite"/></path><rect x="50" y="50" width="20" height="30" fill="#fff" opacity="0.8" /><rect x="45" y="90" width="12" height="20" fill="#b86" stroke="#530" /><rect x="63" y="90" width="12" height="20" fill="#b86" stroke="#530" /><path d="M30,45 L45,40 L40,60 Z" fill="#ffd700" stroke="#fff" stroke-width="2"/><path d="M90,45 L75,40 L80,60 Z" fill="#ffd700" stroke="#fff" stroke-width="2"/><path d="M45,15 L75,15 L75,45 L45,45 Z" fill="#530" stroke="#000" stroke-width="2"/><path d="M45,20 L35,5 L48,15 Z" fill="#fd0" /><path d="M75,20 L85,5 L72,15 Z" fill="#fd0" /><circle cx="53" cy="25" r="4" fill="#fff">${rainbowFill}</circle><circle cx="67" cy="25" r="4" fill="#fff">${rainbowFill}</circle><g transform="translate(80, 50) rotate(-10)"><rect x="-2" y="-10" width="6" height="25" fill="#222" /><path d="M-6,-15 L-6,-70 L0,-80 L6,-70 L6,-15 Z" fill="#ffe" stroke="#ffd700" stroke-width="2">${rainbowAnim}</path></g><circle cx="60" cy="110" r="40" fill="none" stroke="#fff" stroke-width="2" stroke-dasharray="10,5" opacity="0.8">${rainbowAnim}<animateTransform attributeName="transform" type="rotate" from="0 60 110" to="360 60 110" dur="3s" repeatCount="indefinite"/></circle>`);
    createSvgAsset('morph_dk_platinum_70', `<path d="M40,40 Q60,20 80,40 L90,100 Q60,115 30,100 Z" fill="#2e004e" stroke="#9370db" stroke-width="2">${rainbowAnim}</path><path d="M45,40 L75,40 L80,90 L40,90 Z" fill="#f5f5f5" stroke="#a9a9a9" stroke-width="2"><animate attributeName="filter" values="drop-shadow(0 0 5px white);drop-shadow(0 0 15px cyan);drop-shadow(0 0 5px white)" dur="1s" repeatCount="indefinite"/></path><rect x="50" y="50" width="20" height="30" fill="#e6e6fa" /><rect x="45" y="90" width="12" height="20" fill="#f5f5f5" stroke="#a9a9a9" /><rect x="63" y="90" width="12" height="20" fill="#f5f5f5" stroke="#a9a9a9" /><path d="M30,45 L45,40 L40,60 Z" fill="#9370db" stroke="#4b0082" stroke-width="2"/><path d="M90,45 L75,40 L80,60 Z" fill="#9370db" stroke="#4b0082" stroke-width="2"/><path d="M45,15 L75,15 L75,45 L45,45 Z" fill="#191970" stroke="#000" stroke-width="2"/><path d="M45,20 L35,5 L48,15 Z" fill="#0ff" /><path d="M75,20 L85,5 L72,15 Z" fill="#0ff" /><circle cx="53" cy="25" r="4" fill="#0ff">${rainbowFill}</circle><circle cx="67" cy="25" r="4" fill="#0ff">${rainbowFill}</circle><g transform="translate(80, 50) rotate(-10)"><rect x="-2" y="-10" width="4" height="20" fill="#444" /><path d="M-4,-12 L-4,-60 L0,-65 L4,-60 L4,-12 Z" fill="#fff" stroke="#0ff" stroke-width="2">${rainbowAnim}</path></g><circle cx="60" cy="110" r="40" fill="none" stroke="#fff" stroke-width="2" stroke-dasharray="10,5" opacity="0.8">${rainbowAnim}<animateTransform attributeName="transform" type="rotate" from="0 60 110" to="-360 60 110" dur="3s" repeatCount="indefinite"/></circle>`);
    createSvgAsset('morph_dk_red_70', `<path d="M40,40 Q60,20 80,40 L90,100 Q60,115 30,100 Z" fill="#200" stroke="#f00" stroke-width="2">${rainbowAnim}</path><path d="M45,40 L75,40 L80,90 L40,90 Z" fill="#600" stroke="#f00" stroke-width="2"><animate attributeName="filter" values="drop-shadow(0 0 5px red);drop-shadow(0 0 15px orange);drop-shadow(0 0 5px red)" dur="0.5s" repeatCount="indefinite"/></path><rect x="50" y="50" width="20" height="30" fill="#f00" /><rect x="45" y="90" width="12" height="20" fill="#600" stroke="#300" /><rect x="63" y="90" width="12" height="20" fill="#600" stroke="#300" /><path d="M30,45 L45,40 L40,60 Z" fill="#f00" stroke="#ff0" stroke-width="2"/><path d="M90,45 L75,40 L80,60 Z" fill="#f00" stroke="#ff0" stroke-width="2"/><path d="M45,15 L75,15 L75,45 L45,45 Z" fill="#400" stroke="#000" stroke-width="2"/><path d="M45,20 L35,5 L48,15 Z" fill="#ff0" /><path d="M75,20 L85,5 L72,15 Z" fill="#ff0" /><circle cx="53" cy="25" r="4" fill="#f80">${rainbowFill}</circle><circle cx="67" cy="25" r="4" fill="#f80">${rainbowFill}</circle><g transform="translate(80, 50) rotate(-10)"><rect x="-2" y="-10" width="4" height="20" fill="#444" /><path d="M-4,-12 L-4,-60 L0,-65 L4,-60 L4,-12 Z" fill="#f00" stroke="#ff0" stroke-width="2">${rainbowAnim}</path></g><circle cx="60" cy="110" r="40" fill="none" stroke="#f00" stroke-width="2" stroke-dasharray="10,5" opacity="0.8">${rainbowAnim}<animateTransform attributeName="transform" type="rotate" from="0 60 110" to="360 60 110" dur="2s" repeatCount="indefinite"/></circle>`);
    createSvgAsset('morph_high_elf_70', `<ellipse cx="60" cy="110" rx="30" ry="8" fill="rgba(0,0,0,0.5)" /><path d="M40,40 Q60,20 80,40 L90,95 Q60,110 30,95 Z" fill="#004400" stroke="#da0" stroke-width="2">${rainbowAnim}</path><path d="M45,40 L75,40 L78,85 L42,85 Z" fill="#f0fff0" stroke="#006400" stroke-width="2"><animate attributeName="filter" values="drop-shadow(0 0 5px gold);drop-shadow(0 0 15px white);drop-shadow(0 0 5px gold)" dur="2s" repeatCount="indefinite"/></path><rect x="50" y="50" width="20" height="30" fill="#98fb98" /><path d="M40,40 L30,45 L42,55 Z" fill="#daa520" stroke="#0f0" /><path d="M80,40 L90,45 L78,55 Z" fill="#daa520" stroke="#0f0" /><circle cx="60" cy="30" r="14" fill="#ffe" /><path d="M46,20 Q60,5 74,20" fill="none" stroke="#ff0" stroke-width="4">${rainbowAnim}</path><rect x="45" y="85" width="10" height="25" fill="#f0fff0" stroke="#006400" /><rect x="65" y="85" width="10" height="25" fill="#f0fff0" stroke="#006400" /><g transform="translate(20, 50)"><path d="M10,-15 Q50,20 10,60" fill="none" stroke="#ff0" stroke-width="5" filter="drop-shadow(0 0 10px gold)">${rainbowAnim}</path><line x1="10" y1="-15" x2="10" y2="60" stroke="#fff" stroke-width="2"/></g><circle cx="60" cy="60" r="50" fill="none" stroke="#fff" stroke-width="1" stroke-dasharray="2,4" opacity="0.5">${rainbowAnim}<animateTransform attributeName="transform" type="rotate" from="0 60 60" to="360 60 60" dur="5s" repeatCount="indefinite"/></circle>`);

    createSvgAsset('mob_dummy', `<ellipse cx="60" cy="110" rx="25" ry="8" fill="rgba(0,0,0,0.5)" /><rect x="55" y="80" width="10" height="30" fill="#532" /><rect x="40" y="40" width="40" height="50" fill="#da8" stroke="#864" stroke-width="2"/><line x1="20" y1="55" x2="100" y2="55" stroke="#864" stroke-width="4"/><circle cx="60" cy="30" r="15" fill="#db9" stroke="#864" /><path d="M55,25 L58,28 M65,25 L62,28" stroke="#000" stroke-width="2"/>`);
    createSvgAsset('mob_summon_creature', `<circle cx="60" cy="60" r="40" fill="rgba(65, 105, 225, 0.6)" stroke="#aaf" stroke-width="2" /><circle cx="60" cy="60" r="25" fill="#fff" filter="blur(5px)" /><circle cx="45" cy="50" r="4" fill="#00f" /><circle cx="75" cy="50" r="4" fill="#00f" />`);
    createSvgAsset('mob_goblin', `<ellipse cx="60" cy="100" rx="20" ry="6" fill="rgba(0,0,0,0.5)" /><path d="M45,50 L75,50 L70,85 L50,85 Z" fill="#6a6" stroke="#252"/><circle cx="60" cy="40" r="12" fill="#6b6" /><path d="M48,35 L40,25 L48,42 Z" fill="#6b6" /> <path d="M72,35 L80,25 L72,42 Z" fill="#6b6" /><path d="M55,38 L58,40 M65,38 L62,40" stroke="#000" /><path d="M75,60 L85,50 L88,52 L78,65 Z" fill="#ccc" stroke="#555" />`);
    createSvgAsset('mob_kobold', `<ellipse cx="60" cy="100" rx="20" ry="6" fill="rgba(0,0,0,0.5)" /><rect x="45" y="50" width="30" height="35" fill="#b85" /><path d="M45,50 L35,65 L45,60 Z" fill="#b85" /> <path d="M75,50 L85,65 L75,60 Z" fill="#b85" /><circle cx="60" cy="35" r="14" fill="#a74" /><path d="M55,35 L60,42 L65,35 Z" fill="#000" /><rect x="75" y="55" width="5" height="20" fill="#642" transform="rotate(-30 75 55)" />`);
    createSvgAsset('mob_orc', `<ellipse cx="60" cy="105" rx="25" ry="8" fill="rgba(0,0,0,0.5)" /><rect x="40" y="45" width="40" height="40" fill="#674" /><circle cx="60" cy="35" r="16" fill="#785" /><path d="M55,42 L55,35 M65,42 L65,35" stroke="#fff" stroke-width="3"/><rect x="80" y="50" width="8" height="30" fill="#532" transform="rotate(-15 80 50)" />`);
    createSvgAsset('mob_dwarf', `<ellipse cx="60" cy="95" rx="18" ry="5" fill="rgba(0,0,0,0.5)" /><rect x="45" y="55" width="30" height="30" fill="#853" /><circle cx="60" cy="40" r="12" fill="#db9" /><path d="M50,45 Q60,60 70,45" fill="#ccc" stroke="#aaa" /><rect x="75" y="60" width="20" height="8" fill="#555" />`);
    createSvgAsset('mob_orc_fighter', `<ellipse cx="60" cy="105" rx="25" ry="8" fill="rgba(0,0,0,0.5)" /><rect x="40" y="45" width="40" height="40" fill="#674" /><rect x="40" y="55" width="40" height="20" fill="#333" stroke="#111" /><circle cx="60" cy="35" r="16" fill="#785" /><path d="M52,38 L55,45 L65,45 L68,38" fill="#fff" /><path d="M85,40 L95,20 L98,22 L88,45 Z" fill="#ccc" stroke="#555" />`);
    createSvgAsset('mob_werewolf', `<ellipse cx="60" cy="110" rx="30" ry="8" fill="rgba(0,0,0,0.5)" /><path d="M40,50 L80,50 L75,90 L45,90 Z" fill="#778" /><path d="M40,50 L20,70 L30,80 Z" fill="#778" /> <path d="M80,50 L100,70 L90,80 Z" fill="#778" /><circle cx="60" cy="35" r="18" fill="#778" /><path d="M45,20 L50,30 L40,30 Z" fill="#778" /> <path d="M75,20 L70,30 L80,30 Z" fill="#778" /><path d="M55,45 L65,45 L60,52 Z" fill="#000" />`);
    createSvgAsset('mob_ungoliant', `<ellipse cx="60" cy="100" rx="35" ry="10" fill="rgba(0,0,0,0.5)" /><ellipse cx="60" cy="80" rx="25" ry="30" fill="#404" stroke="#202" /><circle cx="60" cy="45" r="15" fill="#303" /><path d="M60,45 L30,20 M60,45 L90,20 M60,55 L20,70 M60,55 L100,70" stroke="#404" stroke-width="4" fill="none" /><circle cx="55" cy="40" r="2" fill="#f00" /> <circle cx="65" cy="40" r="2" fill="#f00" />`);
    createSvgAsset('mob_skeleton', `<ellipse cx="60" cy="110" rx="20" ry="6" fill="rgba(0,0,0,0.5)" /><rect x="55" y="50" width="10" height="30" fill="#eee" /><line x1="45" y1="60" x2="75" y2="60" stroke="#eee" stroke-width="2"/><line x1="45" y1="70" x2="75" y2="70" stroke="#eee" stroke-width="2"/><rect x="52" y="30" width="16" height="18" fill="#eee" rx="2" /><rect x="55" y="35" width="4" height="4" fill="#000" /> <rect x="61" y="35" width="4" height="4" fill="#000" /><line x1="60" y1="80" x2="50" y2="105" stroke="#eee" stroke-width="3"/><line x1="60" y1="80" x2="70" y2="105" stroke="#eee" stroke-width="3"/><line x1="80" y1="60" x2="80" y2="30" stroke="#aaa" stroke-width="2"/>`);
    createSvgAsset('mob_ghoul', `<ellipse cx="60" cy="110" rx="25" ry="8" fill="rgba(0,0,0,0.5)" /><rect x="40" y="50" width="40" height="40" fill="#565" /><rect x="50" y="60" width="20" height="15" fill="#822" /><circle cx="60" cy="35" r="15" fill="#454" /><circle cx="55" cy="35" r="3" fill="#f00" /><path d="M40,50 L30,80 M80,50 L90,80" stroke="#565" stroke-width="6"/>`);
    createSvgAsset('mob_lycanthrope', `<ellipse cx="60" cy="110" rx="30" ry="8" fill="rgba(0,0,0,0.5)" /><path d="M40,50 L80,50 L75,90 L45,90 Z" fill="#333" /><circle cx="60" cy="35" r="18" fill="#333" /><path d="M45,20 L50,30 L40,30 Z" fill="#333" /> <path d="M75,20 L70,30 L80,30 Z" fill="#333" /><path d="M55,45 L65,45 L60,52 Z" fill="#aaa" /><circle cx="55" cy="35" r="2" fill="#f00" /> <circle cx="65" cy="35" r="2" fill="#f00" />`);
    createSvgAsset('mob_ant', `<ellipse cx="60" cy="100" rx="35" ry="10" fill="rgba(0,0,0,0.5)" /><ellipse cx="30" cy="80" rx="15" ry="12" fill="#111" /><ellipse cx="60" cy="80" rx="10" ry="8" fill="#111" /><ellipse cx="90" cy="80" rx="18" ry="15" fill="#111" /><path d="M60,80 L50,105 M60,80 L70,105 M50,80 L40,105" stroke="#111" stroke-width="3" /><path d="M20,80 L10,70 M20,80 L10,90" stroke="#111" stroke-width="2" />`);
    createSvgAsset('mob_gast', `<ellipse cx="60" cy="110" rx="35" ry="10" fill="rgba(0,0,0,0.5)" /><rect x="30" y="50" width="60" height="40" fill="#666" rx="5" /><circle cx="60" cy="35" r="15" fill="#666" /><rect x="10" y="50" width="20" height="40" fill="#666" rx="5" /><rect x="90" y="50" width="20" height="40" fill="#666" rx="5" /><circle cx="55" cy="35" r="3" fill="#a00" /> <circle cx="65" cy="35" r="3" fill="#a00" />`);
    createSvgAsset('mob_lizardman', `<ellipse cx="60" cy="110" rx="25" ry="8" fill="rgba(0,0,0,0.5)" /><path d="M45,50 L75,50 L70,90 L50,90 Z" fill="#682" /><path d="M45,50 L30,30 L60,25 L80,35 Z" fill="#682" /><path d="M50,90 Q30,100 20,80" fill="none" stroke="#682" stroke-width="5" /><line x1="80" y1="20" x2="60" y2="80" stroke="#852" stroke-width="2"/><path d="M80,20 L75,10 L85,10 Z" fill="#ccc" />`);
    createSvgAsset('mob_bandit', `<ellipse cx="60" cy="110" rx="25" ry="8" fill="rgba(0,0,0,0.5)" /><rect x="45" y="50" width="30" height="40" fill="#853" /><circle cx="60" cy="35" r="12" fill="#db9" /><rect x="50" y="30" width="20" height="6" fill="#f00" /><path d="M80,60 L90,40 L95,45 L85,65 Z" fill="#ccc" stroke="#555" />`);
    createSvgAsset('mob_yeti', `<ellipse cx="60" cy="115" rx="35" ry="10" fill="rgba(0,0,0,0.5)" /><ellipse cx="60" cy="70" rx="40" ry="45" fill="#fcfcfc" /><circle cx="50" cy="60" r="4" fill="#000" /> <circle cx="70" cy="60" r="4" fill="#000" /><path d="M55,80 Q60,90 65,80" fill="none" stroke="#000" stroke-width="2"/>`);
    createSvgAsset('mob_elmore_soldier', `<ellipse cx="60" cy="110" rx="25" ry="8" fill="rgba(0,0,0,0.5)" /><rect x="40" y="45" width="40" height="45" fill="#532" /><path d="M40,55 L80,55" stroke="#321" stroke-width="2"/><circle cx="60" cy="35" r="14" fill="#753" /><rect x="55" y="25" width="10" height="20" fill="#321" /><line x1="90" y1="30" x2="80" y2="80" stroke="#888" stroke-width="2"/>`);
    createSvgAsset('mob_medusa', `<ellipse cx="60" cy="110" rx="30" ry="8" fill="rgba(0,0,0,0.5)" /><path d="M45,50 L75,50 L70,80 L50,80 Z" fill="#dca" /><path d="M50,80 Q30,110 80,110" fill="none" stroke="#252" stroke-width="15" stroke-linecap="round"/><circle cx="60" cy="35" r="12" fill="#dca" /><path d="M50,30 Q40,10 50,20 M60,30 Q60,10 70,20 M70,30 Q80,10 65,15" fill="none" stroke="#252" stroke-width="2"/><path d="M80,50 Q90,50 90,70" fill="none" stroke="#852" stroke-width="2"/><line x1="90" y1="50" x2="90" y2="70" stroke="#ccc" />`);
    createSvgAsset('mob_dragon_fly', `<ellipse cx="60" cy="100" rx="30" ry="10" fill="rgba(0,0,0,0.5)" /><path d="M40,60 L80,60 L70,90 L50,90 Z" fill="#543" /><path d="M40,60 L10,30 L30,50 Z" fill="#754" /> <path d="M80,60 L110,30 L90,50 Z" fill="#754" /><path d="M60,60 L60,40 L80,50 Z" fill="#543" /><path d="M60,90 L50,110 L70,110 Z" fill="#543" />`);
    createSvgAsset('mob_fire_egg', `<ellipse cx="60" cy="110" rx="20" ry="6" fill="rgba(0,0,0,0.5)" /><circle cx="60" cy="60" r="30" fill="#f40" /><circle cx="60" cy="60" r="20" fill="#fb0" /><path d="M60,30 Q70,10 60,0 M50,40 Q40,20 50,10" fill="none" stroke="#f00" stroke-width="3"/>`);
    createSvgAsset('mob_succubus', `<ellipse cx="60" cy="110" rx="25" ry="8" fill="rgba(0,0,0,0.5)" /><path d="M48,50 L72,50 L70,90 L50,90 Z" fill="#eac" /><rect x="50" y="55" width="20" height="25" fill="#828" /><circle cx="60" cy="35" r="12" fill="#eac" /><path d="M48,55 L20,30 L40,45 Z" fill="#000" opacity="0.8"/><path d="M72,55 L100,30 L80,45 Z" fill="#000" opacity="0.8"/>`);
    createSvgAsset('mob_living_armor', `<ellipse cx="60" cy="110" rx="25" ry="8" fill="rgba(0,0,0,0.5)" /><rect x="40" y="45" width="40" height="50" fill="#789" stroke="#567" stroke-width="2"/><rect x="45" y="20" width="30" height="25" fill="#789" stroke="#567" stroke-width="2"/><rect x="50" y="28" width="8" height="4" fill="#000" /> <rect x="62" y="28" width="8" height="4" fill="#000" /><line x1="85" y1="50" x2="100" y2="80" stroke="#ccc" stroke-width="4"/>`);
    createSvgAsset('mob_minotaur', `<ellipse cx="60" cy="115" rx="35" ry="10" fill="rgba(0,0,0,0.5)" /><rect x="40" y="50" width="40" height="40" fill="#b82" /><circle cx="60" cy="35" r="20" fill="#d92" /><path d="M45,25 L35,10 L50,20 Z" fill="#eee" /> <path d="M75,25 L85,10 L70,20 Z" fill="#eee" /><rect x="55" y="40" width="10" height="8" fill="#000" rx="2" /><line x1="90" y1="40" x2="90" y2="90" stroke="#532" stroke-width="5"/><circle cx="90" cy="40" r="10" fill="#888" />`);
    createSvgAsset('mob_dark_elf', `<ellipse cx="60" cy="110" rx="25" ry="8" fill="rgba(0,0,0,0.5)" /><rect x="45" y="50" width="30" height="40" fill="#444" /><rect x="45" y="50" width="30" height="40" fill="none" stroke="#fd0" stroke-width="1" /><circle cx="60" cy="35" r="12" fill="#dca" /><path d="M45,35 L35,20 L45,25 Z" fill="#eee" /><line x1="80" y1="40" x2="95" y2="30" stroke="#ccc" stroke-width="2"/>`);
    createSvgAsset('mob_snake_woman', `<ellipse cx="60" cy="110" rx="30" ry="8" fill="rgba(0,0,0,0.5)" /><path d="M45,50 L75,50 L75,80 Q90,100 60,110 Q30,100 45,80 Z" fill="#682" /><circle cx="60" cy="35" r="12" fill="#db9" /><path d="M80,60 L90,40 L95,45 L85,65 Z" fill="#ccc" stroke="#555" />`);
    createSvgAsset('mob_anubis', `<ellipse cx="60" cy="110" rx="35" ry="10" fill="rgba(0,0,0,0.5)" /><rect x="40" y="50" width="40" height="40" fill="#000" /><path d="M40,50 L60,80 L80,50" fill="#fd0" opacity="0.5"/><path d="M50,40 L60,20 L70,40 Z" fill="#000" /><rect x="55" y="30" width="10" height="15" fill="#000" /><rect x="50" y="50" width="20" height="5" fill="#fd0" /><line x1="90" y1="30" x2="90" y2="100" stroke="#fd0" stroke-width="3"/>`);
    createSvgAsset('mob_void_spirit', `<ellipse cx="60" cy="110" rx="30" ry="10" fill="rgba(0,0,0,0.5)" /><path d="M40,30 L80,30 L90,110 L30,110 Z" fill="#000" /><circle cx="60" cy="30" r="10" fill="#000" /><circle cx="56" cy="30" r="2" fill="#fff" /> <circle cx="64" cy="30" r="2" fill="#fff" /><path d="M80,50 L110,20" stroke="#ccc" stroke-width="3"/><path d="M110,20 Q100,50 90,40" fill="#ccc" />`);
    createSvgAsset('mob_araneid', `<ellipse cx="60" cy="100" rx="40" ry="15" fill="rgba(0,0,0,0.5)" /><ellipse cx="60" cy="70" rx="35" ry="40" fill="#520" /><circle cx="60" cy="30" r="15" fill="#310" /><path d="M60,30 L20,10 M60,30 L100,10 M60,40 L10,60 M60,40 L110,60" stroke="#520" stroke-width="5" fill="none" /><circle cx="55" cy="25" r="3" fill="#f00" /> <circle cx="65" cy="25" r="3" fill="#f00" />`);
    createSvgAsset('mob_necromancer', `<ellipse cx="60" cy="110" rx="30" ry="10" fill="rgba(0,0,0,0.5)" /><path d="M35,40 L85,40 L90,105 L30,105 Z" fill="#213" /><circle cx="60" cy="30" r="12" fill="#dca" /><rect x="50" y="20" width="20" height="10" fill="#213" /><line x1="90" y1="30" x2="90" y2="100" stroke="#630" stroke-width="3"/><circle cx="90" cy="30" r="5" fill="#f00" />`);
    createSvgAsset('mob_giant_ant_queen', `<ellipse cx="60" cy="110" rx="40" ry="15" fill="rgba(0,0,0,0.5)" /><ellipse cx="30" cy="80" rx="20" ry="15" fill="#111" /><ellipse cx="60" cy="80" rx="15" ry="12" fill="#111" /><ellipse cx="100" cy="80" rx="30" ry="25" fill="#222" stroke="#111" /><path d="M60,80 L50,110 M60,80 L70,110" stroke="#111" stroke-width="4" /><path d="M20,80 L10,60 M20,80 L10,100" stroke="#111" stroke-width="3" />`);
    createSvgAsset('mob_giant_crocodile', `<ellipse cx="60" cy="110" rx="50" ry="15" fill="rgba(0,0,0,0.5)" /><ellipse cx="60" cy="80" rx="45" ry="20" fill="#252" /><path d="M90,70 L115,80 L90,90" fill="#252" /><path d="M95,75 L95,85" stroke="#fff" stroke-width="2"/><path d="M20,80 L5,70" stroke="#252" stroke-width="3"/>`);
    createSvgAsset('mob_drake', `<ellipse cx="60" cy="110" rx="40" ry="15" fill="rgba(0,0,0,0.5)" /><path d="M30,60 L90,60 L80,100 L40,100 Z" fill="#321" /><path d="M30,60 L0,20 L20,50 Z" fill="#532" /> <path d="M90,60 L120,20 L100,50 Z" fill="#532" /><path d="M60,60 L60,30 L80,45 Z" fill="#321" /><circle cx="65" cy="35" r="2" fill="#f00" />`);
    createSvgAsset('mob_demon', `<ellipse cx="60" cy="110" rx="35" ry="10" fill="rgba(0,0,0,0.5)" /><path d="M40,50 L80,50 L75,100 L45,100 Z" fill="#a00" /><circle cx="60" cy="35" r="18" fill="#a00" /><path d="M50,20 L40,5 L55,20 Z" fill="#000" /> <path d="M70,20 L80,5 L65,20 Z" fill="#000" /><path d="M40,50 L10,20 L30,40 Z" fill="#300" /> <path d="M80,50 L110,20 L90,40 Z" fill="#300" />`);
    createSvgAsset('mob_death_knight', `<path d="M40,40 Q60,20 80,40 L90,100 Q60,115 30,100 Z" fill="#2a0a1a" stroke="#111" stroke-width="2"/><path d="M45,40 L75,40 L80,90 L40,90 Z" fill="#2c3e50" stroke="#111" stroke-width="2"/><rect x="50" y="50" width="20" height="30" fill="#34495e" /><rect x="45" y="90" width="12" height="20" fill="#2c3e50" stroke="#111" /><rect x="63" y="90" width="12" height="20" fill="#2c3e50" stroke="#111" /><path d="M43,110 L57,110 L57,105 L43,105 Z" fill="#111" /><path d="M63,110 L77,110 L77,105 L63,105 Z" fill="#111" /><path d="M30,45 L45,40 L40,60 Z" fill="#1a1a1a" stroke="#555" stroke-width="1"/><path d="M90,45 L75,40 L80,60 Z" fill="#1a1a1a" stroke="#555" stroke-width="1"/><path d="M45,15 L75,15 L75,45 L45,45 Z" fill="#1c2833" stroke="#000" stroke-width="2"/><path d="M45,20 L35,5 L48,15 Z" fill="#555" /><path d="M75,20 L85,5 L72,15 Z" fill="#555" /><path d="M50,30 L70,30 L60,45 Z" fill="#111" /><circle cx="53" cy="25" r="3" fill="#00ffff"><animate attributeName="opacity" values="0.5;1;0.5" dur="2s" repeatCount="indefinite" /></circle><circle cx="67" cy="25" r="3" fill="#00ffff"><animate attributeName="opacity" values="0.5;1;0.5" dur="2s" repeatCount="indefinite" /></circle><g transform="translate(80, 50) rotate(-10)"><rect x="-2" y="-10" width="4" height="20" fill="#444" /><rect x="-6" y="-12" width="12" height="4" fill="#333" /><path d="M-4,-12 L-4,-60 L0,-65 L4,-60 L4,-12 Z" fill="#aab7b8" stroke="#555" /><path d="M0,-20 L0,-55" stroke="#00ffff" stroke-width="1" opacity="0.3" /></g><circle cx="40" cy="55" r="6" fill="#2c3e50" stroke="#111" /><circle cx="60" cy="110" r="30" fill="none" stroke="#00ffff" stroke-width="1" stroke-dasharray="5,5" opacity="0.3"><animateTransform attributeName="transform" type="rotate" from="0 60 110" to="360 60 110" dur="10s" repeatCount="indefinite"/></circle>`);
    createSvgAsset('mob_baphomet', `<ellipse cx="60" cy="110" rx="35" ry="10" fill="rgba(0,0,0,0.5)" /><path d="M35,45 L85,45 L80,100 L40,100 Z" fill="#223" /><path d="M60,45 L40,20 L60,30 Z" fill="#223" /> <path d="M60,45 L80,20 L60,30 Z" fill="#223" /><path d="M40,20 L30,5" stroke="#ccc" stroke-width="2"/> <path d="M80,20 L90,5" stroke="#ccc" stroke-width="2"/><circle cx="60" cy="35" r="15" fill="#223" /><circle cx="55" cy="35" r="2" fill="#f00" /> <circle cx="65" cy="35" r="2" fill="#f00" /><path d="M85,50 L100,20 L105,25 L90,60 Z" fill="#334" />`);
    createSvgAsset('mob_dante', `<ellipse cx="60" cy="110" rx="30" ry="8" fill="rgba(0,0,0,0.5)" /><rect x="40" y="45" width="40" height="50" fill="#314" stroke="#fd0" stroke-width="1"/><circle cx="60" cy="30" r="12" fill="#314" /><rect x="50" y="25" width="20" height="5" fill="#fd0" /><line x1="85" y1="50" x2="105" y2="80" stroke="#f00" stroke-width="4"/>`);
    createSvgAsset('mob_zebulon', `<ellipse cx="60" cy="110" rx="35" ry="10" fill="rgba(0,0,0,0.5)" /><path d="M40,50 L80,50 L75,100 L45,100 Z" fill="#452" /><circle cx="60" cy="35" r="15" fill="#452" /><path d="M50,20 L45,5 L55,20 Z" fill="#231" /> <path d="M70,20 L75,5 L65,20 Z" fill="#231" /><line x1="85" y1="50" x2="105" y2="30" stroke="#252" stroke-width="3"/>`);
    createSvgAsset('mob_osiris', `<ellipse cx="60" cy="110" rx="35" ry="10" fill="rgba(0,0,0,0.5)" /><rect x="40" y="45" width="40" height="50" fill="#fd0" /><path d="M40,45 L20,20 L40,35 Z" fill="#369" /> <path d="M80,45 L100,20 L80,35 Z" fill="#369" /><rect x="50" y="25" width="20" height="20" fill="#fd0" /><path d="M50,25 L50,10 L70,10 L70,25 Z" fill="#369" /><line x1="90" y1="30" x2="90" y2="100" stroke="#369" stroke-width="4"/>`);
    createSvgAsset('mob_girtao', `<defs><radialGradient id="gG"><stop offset="0%" stop-color="#408"/><stop offset="100%" stop-color="#102"/></radialGradient></defs><ellipse cx="60" cy="110" rx="50" ry="15" fill="rgba(0,0,0,0.8)" /><path d="M20,110 L40,50 L80,50 L100,110 Z" fill="url(#gG)" /><circle cx="60" cy="40" r="25" fill="#204" /><circle cx="50" cy="35" r="4" fill="#f00" /> <circle cx="70" cy="35" r="4" fill="#f00" /><path d="M40,20 L30,0 L50,20 Z" fill="#000" /> <path d="M80,20 L90,0 L70,20 Z" fill="#000" /><path d="M10,80 L30,60 L20,90 Z" fill="#315" /> <path d="M110,80 L90,60 L100,90 Z" fill="#315" />`);

    // --- 投射物與特效 SVG ---
    createSvgAsset('proj_arrow', `<line x1="10" y1="60" x2="110" y2="60" stroke="#ccc" stroke-width="2" /><path d="M110,60 L90,55 L90,65 Z" fill="#ccc" /><path d="M10,60 L20,50 M10,60 L20,70" stroke="#eee" stroke-width="2" />`);
    createSvgAsset('proj_arrow_triple', `<g opacity="0.9"><line x1="10" y1="50" x2="110" y2="50" stroke="#adf" stroke-width="4" stroke-linecap="round"/><path d="M110,50 L90,42 L90,58 Z" fill="#adf" /></g><g><line x1="0" y1="60" x2="120" y2="60" stroke="#fff" stroke-width="5" stroke-linecap="round"/><path d="M120,60 L95,50 L95,70 Z" fill="#fff" /></g><g opacity="0.9"><line x1="10" y1="70" x2="110" y2="70" stroke="#adf" stroke-width="4" stroke-linecap="round"/><path d="M110,70 L90,62 L90,78 Z" fill="#adf" /></g>`);
    createSvgAsset('proj_magic_arrow', `<defs><linearGradient id="gradMagic" x1="0%" y1="0%" x2="100%" y2="0%"><stop offset="0%" style="stop-color:#00f;stop-opacity:0" /><stop offset="50%" style="stop-color:#0ff;stop-opacity:1" /><stop offset="100%" style="stop-color:#fff;stop-opacity:1" /></linearGradient></defs><line x1="10" y1="60" x2="110" y2="60" stroke="url(#gradMagic)" stroke-width="4" stroke-linecap="round" /><path d="M80,60 L50,50 L50,70 Z" fill="#0ff" opacity="0.5"><animate attributeName="opacity" values="0.5;0;0.5" dur="0.2s" repeatCount="indefinite"/></path>`);
    createSvgAsset('proj_fireball', `<defs><radialGradient id="gradFire"><stop offset="0%" stop-color="#fff"/><stop offset="30%" stop-color="#ff0"/><stop offset="70%" stop-color="#f40"/><stop offset="100%" stop-color="#500"/></radialGradient></defs><circle cx="60" cy="60" r="45" fill="url(#gradFire)" /><circle cx="60" cy="60" r="50" fill="none" stroke="#f40" stroke-width="2" opacity="0.5"><animate attributeName="r" values="45;55;45" dur="0.5s" repeatCount="indefinite"/></circle>`);
    createSvgAsset('effect_fire_area', `<circle cx="60" cy="60" r="10" fill="#fff"><animate attributeName="r" values="10;60" dur="0.4s" fill="freeze" /><animate attributeName="opacity" values="1;0" dur="0.4s" fill="freeze" /></circle><circle cx="60" cy="60" r="20" fill="none" stroke="#ff0" stroke-width="10"><animate attributeName="r" values="20;70" dur="0.5s" fill="freeze" /><animate attributeName="opacity" values="1;0" dur="0.5s" fill="freeze" /></circle><circle cx="60" cy="60" r="30" fill="none" stroke="#f40" stroke-width="5"><animate attributeName="r" values="30;80" dur="0.6s" fill="freeze" /><animate attributeName="opacity" values="1;0" dur="0.6s" fill="freeze" /></circle>`);

    // [V77.83 Fix] 火風暴：地面大範圍旋渦，移除模糊濾鏡以提升效能，改用多重路徑
    createSvgAsset('effect_fire_storm', `<defs><radialGradient id="gFire" cx="0.5" cy="0.5" r="0.5"><stop offset="0" stop-color="#fff"/><stop offset="0.4" stop-color="#ff0"/><stop offset="0.8" stop-color="#f00"/><stop offset="1" stop-color="transparent"/></radialGradient></defs><g opacity="0.8"><path d="M60,60 m-50,0 a50,50 0 1,0 100,0 a50,50 0 1,0 -100,0" fill="none" stroke="#f40" stroke-width="8" stroke-dasharray="20,10"><animateTransform attributeName="transform" type="rotate" from="0 60 60" to="360 60 60" dur="2s" repeatCount="indefinite"/></path><path d="M60,60 m-35,0 a35,35 0 1,1 70,0 a35,35 0 1,1 -70,0" fill="none" stroke="#ff0" stroke-width="6" stroke-dasharray="15,15"><animateTransform attributeName="transform" type="rotate" from="360 60 60" to="0 60 60" dur="1.5s" repeatCount="indefinite"/></path><circle cx="60" cy="60" r="20" fill="url(#gFire)" opacity="0.6"><animate attributeName="opacity" values="0.4;0.8;0.4" dur="0.5s" repeatCount="indefinite"/></circle></g>`);
    
    // [V77.83 Fix] 流星雨 (High Performance)：移除 heavy 濾鏡，改用純色塊與透明度，由 Game.js 控制落下
    createSvgAsset('effect_meteor_rain', `<defs><linearGradient id="gMet" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#fff"/><stop offset="30%" stop-color="#fd0"/><stop offset="100%" stop-color="#f00"/></linearGradient></defs><g><rect x="58" y="0" width="4" height="80" fill="url(#gMet)" opacity="0.8" /><circle cx="60" cy="85" r="15" fill="#fff" /><circle cx="60" cy="85" r="25" fill="none" stroke="#f80" stroke-width="2" /></g>`);

    // [V77.83 Fix] 騎士揮劍：調整中心點 (Pivot) 至 (60,60) 以便程式旋轉。劍柄在中心，劍身向外。
    createSvgAsset('effect_slash', `<path d="M60,60 Q100,20 110,60 L100,70 Q90,30 60,60 Z" fill="#fff" opacity="0.8"><animate attributeName="opacity" values="0.8;0" dur="0.3s" fill="freeze"/></path><path d="M60,60 Q90,10 120,50" fill="none" stroke="#fff" stroke-width="5" stroke-linecap="round" opacity="0.5"/>`);
    
    // [V77.83 Fix] 法師揮杖：調整中心點至 (60,60)，藍色魔法軌跡。
    createSvgAsset('effect_staff_swing', `<path d="M60,60 Q90,20 110,70" fill="none" stroke="#0ff" stroke-width="8" stroke-linecap="round" opacity="0.7"><animate attributeName="opacity" values="0.7;0" dur="0.4s" fill="freeze"/></path><circle cx="110" cy="70" r="5" fill="#fff" filter="drop-shadow(0 0 5px #0ff)"/>`);

    function createTree(key, leavesColor) { createSvgAsset(key, `<ellipse cx="60" cy="110" rx="20" ry="6" fill="rgba(0,0,0,0.3)" /><rect x="52" y="80" width="16" height="30" fill="#543" /><path d="M20,80 L100,80 L60,40 Z" fill="${leavesColor[0]}" /><path d="M25,60 L95,60 L60,20 Z" fill="${leavesColor[1]}" />`); }
    createTree('prop_tree_green', ['#141', '#262']); createTree('prop_tree_yellow', ['#860', '#a80']); createTree('prop_tree_red', ['#822', '#a44']); createTree('prop_tree_sakura', ['#fcc', '#fdd']);
    createSvgAsset('prop_rock', `<ellipse cx="60" cy="100" rx="25" ry="8" fill="rgba(0,0,0,0.3)" /><path d="M35,90 L50,60 L80,90 Z" fill="#666" /><path d="M50,90 L70,60 L90,90 Z" fill="#888" />`);
    
    // Canvas Tile Generator
    function createTile(key, color, detail) { 
        var canvas = document.createElement('canvas'); 
        canvas.width=64; 
        canvas.height=64; 
        var ctx = canvas.getContext('2d'); 
        ctx.fillStyle=color; 
        ctx.fillRect(0,0,64,64); 
        if(detail) detail(ctx); 
        Assets[key] = canvas; 
    }
    
    createTile('tile_grass', '#152015', c=>{c.fillStyle='#2a352a'; for(let i=0;i<20;i++) c.fillRect(Math.random()*64,Math.random()*64,2,2);});
    createTile('tile_sand', '#dcb', c=>{c.fillStyle='#ca9'; for(let i=0;i<20;i++) c.fillRect(Math.random()*64,Math.random()*64,3,1);});
    createTile('tile_snow', '#eef', c=>{c.fillStyle='#fff'; for(let i=0;i<10;i++) c.fillRect(Math.random()*64,Math.random()*64,2,2);});
    createTile('tile_dirt', '#3a2a1a', c=>{c.fillStyle='#2a1a0a'; for(let i=0;i<25;i++) c.fillRect(Math.random()*64,Math.random()*64,2,2);});
    createTile('tile_cave', '#222', c=>{c.fillStyle='#111'; for(let i=0;i<10;i++) c.beginPath()||c.arc(Math.random()*64,Math.random()*64,Math.random()*10,0,Math.PI*2)||c.fill();});
    createTile('tile_stone', '#444', c=>{c.strokeStyle='#555'; for(let i=0;i<5;i++) c.strokeRect(Math.random()*64,Math.random()*64,20,20);});
    createTile('tile_void', '#101', c=>{c.fillStyle='#303'; for(let i=0;i<5;i++) c.fillRect(Math.random()*64,Math.random()*64,2,2);});
    
    // 更新載入狀態顯示
    if(document.getElementById('asset-status')) {
        document.getElementById('asset-status').innerText = "V77.83 美術資源優化完成";
    }
}

/**
 * 載入使用者本機圖檔 (選用功能)
 */
function loadAssets(input) { 
    var files = input.files; 
    var count = 0; 
    for (let i = 0; i < files.length; i++) { 
        let file = files[i]; 
        if (file.type.match('image.*')) { 
            let reader = new FileReader(); 
            reader.onload = (function(f) { 
                return function(e) { 
                    let img = new Image(); 
                    img.src = e.target.result; 
                    let key = f.name.split('.')[0].toLowerCase(); 
                    Assets[key] = img; 
                    count++; 
                    if(document.getElementById('asset-status')) {
                        document.getElementById('asset-status').innerText = "已載入外部 " + count + " 張圖片"; 
                    }
                }; 
            })(file); 
            reader.readAsDataURL(file); 
        } 
    } 
}